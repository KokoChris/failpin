<% include ../partials/header %>

<% include ../partials/nav %>
<div class="container">
	<div id ="container">
	</div>
	<button id="load-images"></button>
</div>

<script>
$( function() {

  
  var $container = $('#container');
  // hide initial items
  var $initialItems = $container.find('.item').hide();
  
  var $container = $container.masonry({
      // layout no items initially
      itemSelector: 'no-items',
      columnWidth: 200
    })
    // set proper itemSelector
    .masonry( 'option', { itemSelector: '.item' })
    .masonryImagesReveal( $initialItems );

  $('#load-images').click( function() {
    var $items = getItems();
    $container.masonryImagesReveal( $items );
  });
  
});

// reveals all items after all item images
// have been loaded
$.fn.masonryImagesReveal = function( $items ) {
  var msnry = this.data('masonry');
  var itemSelector = msnry.options.itemSelector;
  // hide by default
  $items.hide();
  // append to container
  this.append( $items );
  $items.imagesLoaded( function() {
    // un-hide items
    $items.show();
    // reveal all of them
    msnry.appended( $items );
  });
  
  return this;
};

function randomInt( min, max ) {
  return Math.floor( Math.random() * max + min );
}

function getItem() {
  var width = randomInt( 150, 400 );
  var height = randomInt( 150, 250 );
  var item = '<div class="item thumbnail">'+
    '<img src="http://lorempixel.com/' + 
      width + '/' + height + '/nature" /><p>KOKOKOKOKO</p></div>';
  return item;
}

function getItems() {
  var items = '';
  for ( var i=0; i < 12; i++ ) {
    items += getItem();
  }
  // return jQuery object
  return $( items );
}

</script>
<% include ../partials/footer %>
